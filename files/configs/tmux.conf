# True 24-bit color support for Claude Code
# default-terminal MUST be tmux-* or screen-*, never xterm-*
# https://github.com/tmux/tmux/wiki/FAQ
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# Interaction
set -g mouse on
setw -g mode-keys vi

# Claude outputs are verbose - increase history
# https://code.claude.com/docs/en/terminal-config
set -g history-limit 50000

# Start numbering at 1 (easier to reach)
# https://builtin.com/articles/tmux-config
set -g base-index 1
setw -g pane-base-index 1

# Faster escape response (default 500ms is sluggish)
# 10-20ms recommended for remote; 0 locally
set -s escape-time 15

# Required for iTerm2 control mode (-CC)
# https://gitlab.com/gnachman/iterm2/-/issues/2585
setw -g aggressive-resize off

# Clipboard integration via OSC 52 (works over SSH + Docker)
# https://github.com/tmux/tmux/wiki/Clipboard
set -g set-clipboard on
set -g allow-passthrough on
set -ag terminal-overrides ",xterm-256color:Ms=\\E]52;c;%p2%s\\7"

# Easy config reload
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# Vim-style pane resize
bind-key -r h resize-pane -L 5
bind-key -r j resize-pane -D 5
bind-key -r k resize-pane -U 5
bind-key -r l resize-pane -R 5

# List all Claude windows
bind C-c choose-tree -s -f '#{==:#{session_name},main}'

# Plugin manager
set -g @plugin 'tmux-plugins/tpm'

# Session persistence
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Auto-restore on tmux start
set -g @continuum-restore 'on'

# Initialize TPM (keep at bottom)
run '~/.tmux/plugins/tpm/tpm'
